\documentclass[times,modern]{aastex63}

% these lines seem necessary for pdflatex to get the paper size right
\pdfpagewidth 8.5in
\pdfpageheight 11.0in

\usepackage[T1]{fontenc}
\usepackage{epsf,color,amsmath}

\usepackage{cancel}

\newcommand{\sfrac}[2]{\mathchoice%
  {\kern0em\raise.5ex\hbox{\the\scriptfont0 #1}\kern-.15em/
    \kern-.15em\lower.25ex\hbox{\the\scriptfont0 #2}}
  {\kern0em\raise.5ex\hbox{\the\scriptfont0 #1}\kern-.15em/
    \kern-.15em\lower.25ex\hbox{\the\scriptfont0 #2}}
  {\kern0em\raise.5ex\hbox{\the\scriptscriptfont0 #1}\kern-.2em/
    \kern-.15em\lower.25ex\hbox{\the\scriptscriptfont0 #2}} {#1\!/#2}}


\newcommand{\castro}{{\sf Castro}}
\newcommand{\maestro}{{\sf Maestro}}
\newcommand{\flash}{{\sf Flash}}
\newcommand{\amrex}{{\sf AMReX}}

\newcommand{\isot}[2]{$^{#2}\mathrm{#1}$}
\newcommand{\isotm}[2]{{}^{#2}\mathrm{#1}}

\newcommand{\gcc}{\mathrm{g~cm^{-3} }}
\newcommand{\cms}{\mathrm{cm~s^{-1} }}

\newcommand{\nablab}{{\mathbf{\nabla}}}
\newcommand{\Ub}{\mathbf{U}}
\newcommand{\gb}{\mathbf{g}}
\newcommand{\omegadot}{\dot{\omega}}
\newcommand{\Sdot}{\dot{S}}
\newcommand{\ddx}[1]{{\frac{{\partial#1}}{\partial x}}}
\newcommand{\ddt}[1]{{\frac{{\partial#1}}{\partial t}}}
\newcommand{\odt}[1]{{\frac{{d#1}}{dt}}}
\newcommand{\divg}[1]{{\nablab \cdot \left (#1\right)}}
\newcommand{\dedr}{\left . {\partial{}e}/{\partial\rho}\right |_{T, X_k}}
\newcommand{\dedrd}{\left . \frac{\partial{}e}{\partial\rho}\right |_{T, X_k}}
\newcommand{\dedX}{\left . {\partial{}e}/{\partial{}X_k} \right |_{\rho, T}}
\newcommand{\dedXd}{\left . \frac{\partial{}e}{\partial{}X_k} \right |_{\rho, T, X_{j,j\ne k}}}
\newcommand{\dedT}{\left . {\partial{}e}/{\partial{}T} \right |_{\rho,X_k}}
\newcommand{\dedTd}{\left . \frac{\partial{}e}{\partial{}T} \right |_{\rho,X_k}}

\newcommand{\Ic}{{\boldsymbol{\mathcal{I}}}}
\newcommand{\Ics}{{\mathcal{I}}}
\newcommand{\smax}{{s_\mathrm{max}}}
\newcommand{\kth}{k_\mathrm{th}}
\usepackage{bm}

\newcommand{\Uc}{{\,\bm{\mathcal{U}}}}
\newcommand{\Fb}{\mathbf{F}}
\newcommand{\Sc}{\mathbf{S}}

\newcommand{\xv}{{(x)}}
\newcommand{\yv}{{(y)}}
\newcommand{\zv}{{(z)}}

\newcommand{\ex}{{\bf e}_x}
\newcommand{\ey}{{\bf e}_y}
\newcommand{\ez}{{\bf e}_z}

\newcommand{\Ab}{{\bf A}}
\newcommand{\Sq}{{\bf S}_\qb}
\newcommand{\Sqhydro}{{\Sq^{\mathrm{hydro}}}}
\newcommand{\qb}{{\bf q}}

\newcommand{\Shydro}{{{\bf H}}}
\newcommand{\Hb}{{\bf H}}
\newcommand{\Rb}{{\bf R}}
\newcommand{\Rq}{{\bf R}}
\newcommand{\Adv}[1]{{\left [\boldsymbol{\mathcal{A}} \left(#1\right)\right]}}
\newcommand{\Advt}[1]{{\left [\boldsymbol{\mathcal{\tilde{A}}} \left(#1\right)\right]}}
\newcommand{\Advss}[1]{{\left [{\mathcal{{A}}} \left(#1\right)\right]}}
\newcommand{\Advs}[1]{\boldsymbol{\mathcal{A}} \left(#1\right)}

\newcommand{\avg}[1]{{\left \langle #1 \right \rangle}}

\newcommand{\nse}[1]{{\mathrm{NSE}( #1 )}}

\newcommand{\rhonse}{{\rho_\mathrm{nse}}}
\newcommand{\tnse}{{T_\mathrm{nse}}}
\newcommand{\Anse}{{A_\mathrm{nse}}}
\newcommand{\Bnse}{{B_\mathrm{nse}}}

\newcommand{\out}{{\rm out}}
\newcommand{\inp}{{\rm in}}

\setlength{\marginparwidth}{0.75in}
\newcommand{\MarginPar}[1]{\marginpar{\vskip-\baselineskip\raggedright\tiny\sffamily\hrule\smallskip{\color{red}#1}\par\smallskip\hrule}}

\begin{document}
%======================================================================
% Title
%======================================================================
%\title{A Simplified Spectral Deferred Correction Method for Coupling Hydrodynamics with Reaction Networks and Nuclear Statistical Equilibrium}
\title{Practical Effects of Integrating Temperature with Strang Split Reactions}

%\shorttitle{A Simplified SDC Method}
\shorttitle{Temperature Integration with Strang}


\shortauthors{}

%% \author[0000-0001-8401-030X]{M.~Zingale}
%% \affiliation{Dept.\ of Physics and Astronomy, Stony Brook University,
%%        Stony Brook, NY 11794-3800}

%% \author[0000-0003-0439-4556]{M.~P.~Katz}
%% \affiliation{Nvidia Corp}

%% \author[0000-0002-5749-334X]{J.~B.~Bell}
%% \affiliation{Center for Computational Sciences and Engineering, Lawrence Berkeley National Laboratory, Berkeley, CA  94720}

%% \author[0000-0003-1791-0265]{A.~J.~Nonaka}
%% \affiliation{Center for Computational Sciences and Engineering, Lawrence Berkeley National Laboratory, Berkeley, CA  94720}

%% \author[0000-0001-8092-1974]{W.~Zhang}
%% \affiliation{Center for Computational Sciences and Engineering, Lawrence Berkeley National Laboratory, Berkeley, CA  94720}

%% \correspondingauthor{Michael Zingale}
%% \email{michael.zingale@stonybrook.edu}


%======================================================================
% Abstract and Keywords
%======================================================================
\begin{abstract}
For astrophysical reacting flows, operator splitting is commonly used
to couple hydrodynamics and reactions.  Each process operates
independent of one another, but by staggering the updates in a
symmetric fashion (via Strang splitting) second order accuracy in time
can be achieved.  However, approximations are often made to the
reacting system, including the choice of whether or not to integrate
temperature with the species.  Here we demonstrate through a simple
convergence test that integrating temperature together with reactions
is needed for second-order accuracy.
\end{abstract}

\keywords{hydrodynamics---methods: numerical}

%======================================================================
% Introduction
%======================================================================
\section{Introduction}\label{Sec:Introduction}


\section{Numerical Methodology}

We are using the freely-available \castro\ simulation
code~\citep{castro,castro_joss}.  \castro\ solves the equations of
hydrodynamics using an unsplit piecewise parabolic method coupled with
gravity and reactions.  For reactive flow, either Strang splitting or
spectral deferred corrections are used to couple the hydrodynamics and
reactions~\citep{castro_sdc}.  Here we focus on the Strang splitting.

One option to make temperature integration less expensive is to freeze
the values of the thermodynamics quantities at the start of the
reactive integration.  This approach was done in \citet{ABNZ:III}.
This can work well in ``simmering'' phases of reactions where the
thermodynamic state is not changing much over a timestep, but for
explosive reactions, this may be a poor approximation.

In \cite{castro_sdc}, we introduced a test problem where we could
measure the convergence of a reacting hydrodynamics problem via
Richardson extrapolation---this was an acoustic pulse with helium
burning via $3$-$\alpha$ and
$\isotm{C}{12}(\alpha,\gamma)\isotm{O}{16}$.  Those tests focused on
SDC coupling and showed that we can get overall 4th order in space and
time convergence.  Here we run the same test with Strang coupling,
looking at the various approaches at incorporating a temperature
equation in the reactive portion of the update.

For each method, we run the \castro\ {\tt reacting\_convergence} test
problem at 5 resolutions: $64^2$, $128^2$, $256^2$, $512^2$, and
$1024^2$.  We then compute four errors between adjacent resolutions by
coarsening the finer resolution run, and computing the $L_1$ norm over
all zones.  Figure~\ref{thefigure} shows the norm of the error
vs.\ the coarse run resolution.  Guidelines showing ideal first and
second order convergence are shown.

\begin{figure}[t]
\centering
\plotone{test}
\caption{\label{thefigure} our results}
\end{figure}

\section{Summary}


\acknowledgements \castro\ is freely available at
\url{http://github.com/AMReX-Astro/Castro}.  All of the code and
problem setups used here are available in the git repo.  The work at
Stony Brook was supported by DOE/Office of Nuclear Physics grant
DE-FG02-87ER40317.  This material is based upon work supported by the
U.S. Department of Energy, Office of Science, Office of Advanced
Scientific Computing Research and Office of Nuclear Physics,
Scientific Discovery through Advanced Computing (SciDAC) program under
Award Number DE-SC0017955.  This research was supported by the
Exascale Computing Project (17-SC-20-SC), a collaborative effort of
the U.S. Department of Energy Office of Science and the National
Nuclear Security Administration.

\software{\amrex\ \citep{amrex_joss},
          \castro\ \citep{castro},
          GNU Compiler Collection (\url{https://gcc.gnu.org/}),
          Linux (\url{https://www.kernel.org}),
          matplotlib (\citealt{Hunter:2007},  \url{http://matplotlib.org/})
          NumPy \citep{numpy,numpy2},
          python (\url{https://www.python.org/}),
          VODE \cite{vode}
         }




%======================================================================
% References
%======================================================================

\bibliographystyle{aasjournal}
\bibliography{ws}

\end{document}
